<%#= render 'post_images/list', post_images: @post_images %>

<div class="container">
  <!--タグリスト-->
  <div class="row border border-dark rounded p-2 mb-4" style="background:#fbfaf5;">
    <div>
      <p class="mb-0"><strong>タグで探す</strong></p>
      <% @tag_list.each do |tag_list| %>
        <% if (tag_list.post_images.count) >= 1 %>
          <%= link_to tag_list.tag_name, search_tag_path(tag_id: tag_list.id) %>
          <%= "(#{tag_list.post_images.count})" %>
          <% end %>
      <% end %>
    </div>
  </div>

  <!--投稿一覧-->
  <div class="row row-cols-1 row-cols-md-4">
    <% @post_images.each do |post_image| %>

      <!--カードスタイル-->
      <div class="card mb-3" style="width:300px;">
        <!--カード画像-->
        <div class="card-img-top" style="height:250px;">
          <%= link_to post_image_path(post_image.id) do %>
            <%= image_tag post_image.get_image, style:"width:100%; height:100%; object-fit:cover;" %>
          <% end %>
        </div>
        <!--カード内容-->
        <div class="card-body">
          <h5 class="card-title mb-0"><%= post_image.title %></h5>
          <div class="card-text">
            <!--星-->
            <div class="star-rating position-relative overflow-hidden" style="width: 5em;">
              <div class="star-rating-front position-absolute top-0 start-0" style="color:#fc0; width:<%= post_image.star_percentage %>%">★★★★★</div>
              <div class="star-rating-back" style="color:#ccc">★★★★★</div>
            </div>
            <div>店名：<%= post_image.shop_name %></div>
            <div><i class="fa-solid fa-user"></i><%= post_image.user.name %></div>
            <div><i class="fa-regular fa-comment"></i>：<%= link_to "#{post_image.post_comments.count}", post_image_path(post_image.id) %></div>

            <!--管理者削除ボタン-->
            <% if current_user&.admin? %>
              <%= link_to "管理者削除", post_image_path(post_image.id), method: :delete, class:"btn btn-danger", data: {confirm:"管理者権限によりこの投稿を削除しますか？"} %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>

</div>